--üåà AutoFishing GUI Full (with Favorite + Filtered AutoSell & Anti AFK)
--‚ö†Ô∏è Place this LocalScript inside StarterGui

local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local player = Players.LocalPlayer

--üì¶ Load Fishing Areas (best-effort require)
local FishingAreas
pcall(function()
    FishingAreas = require(ReplicatedStorage:WaitForChild("Items", 5) or ReplicatedStorage:WaitForChild("FishingAreas", 5))
end)

--üé£ Rare Fish List
local RareFishes = {
	"Lochness Monster", "Robot Kraken", "King Jelly", "Orca",
	"Viperangler Fish", "Mosasaur Shark", "Ancient Arapaima",
	"Sacred Guardian Squid", "Bone Whale"
}

--‚≠ê Favorite rarity map (Mythic + Secret)
local RarityFavorite = {
	["Mythic"] = true,
	["Secret"] = true,
}

--üß± Load Net Remotes (helper)
local function getRemote(path)
	local node = ReplicatedStorage
	for seg in string.gmatch(path, "[^/]+") do
		node = node:FindFirstChild(seg)
		if not node then
			return nil
		end
	end
	return node
end

local baseNet = getRemote("Packages/_Index/sleitnick_net@0.2.0/net")
local RF_Charge = baseNet and baseNet:FindFirstChild("RF/ChargeFishingRod")
local RF_Start = baseNet and baseNet:FindFirstChild("RF/RequestFishingMinigameStarted")
local RE_Complete = baseNet and baseNet:FindFirstChild("RE/FishingCompleted")
local RF_Radar = baseNet and baseNet:FindFirstChild("RF/UpdateFishingRadar")
local RF_SellAll = baseNet and baseNet:FindFirstChild("RF/SellAllItems")
local RE_Equip = baseNet and baseNet:FindFirstChild("RE/EquipToolFromHotbar")
-- favorite remote (might be RE or RF depending on place)
local REM_FAVORITE = baseNet and (baseNet:FindFirstChild("RE/FavoriteItem") or baseNet:FindFirstChild("RF/FavoriteItem"))

-- try to require items module if present (best-effort)
local ItemsModule = nil
pcall(function()
	if ReplicatedStorage:FindFirstChild("Assets") and ReplicatedStorage.Assets:FindFirstChild("Items") and ReplicatedStorage.Assets.Items:FindFirstChild("Items") then
		ItemsModule = require(ReplicatedStorage.Assets.Items.Items)
	end
end)

-- GUI Setup
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "AutoSystemUI"
screenGui.ResetOnSpawn = false
screenGui.Parent = player:WaitForChild("PlayerGui")

local frame = Instance.new("Frame")
frame.Size = UDim2.new(0, 320, 0, 350)
frame.Position = UDim2.new(0.02, 0, 0.55, 0)
frame.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
frame.BorderSizePixel = 0
frame.Active = true
frame.Draggable = true
frame.Parent = screenGui

local corner = Instance.new("UICorner")
corner.CornerRadius = UDim.new(0, 12)
corner.Parent = frame

local uiStroke = Instance.new("UIStroke")
uiStroke.Thickness = 2
uiStroke.Color = Color3.fromRGB(255, 200, 100)
uiStroke.Parent = frame

local title = Instance.new("TextLabel")
title.Size = UDim2.new(1, -40, 0, 30)
title.Position = UDim2.new(0, 10, 0, 5)
title.BackgroundTransparency = 1
title.Font = Enum.Font.GothamBold
title.TextSize = 20
title.Text = "üé£ Auto System"
title.TextColor3 = Color3.fromRGB(255, 255, 255)
title.TextXAlignment = Enum.TextXAlignment.Left
title.Parent = frame

-- Close & Minimize Buttons
local closeBtn = Instance.new("TextButton")
closeBtn.Size = UDim2.new(0, 28, 0, 28)
closeBtn.Position = UDim2.new(1, -32, 0, 2)
closeBtn.BackgroundColor3 = Color3.fromRGB(255, 80, 80)
closeBtn.Font = Enum.Font.GothamBold
closeBtn.TextColor3 = Color3.fromRGB(255,255,255)
closeBtn.TextSize = 20
closeBtn.Text = "X"
closeBtn.BorderSizePixel = 0
closeBtn.Parent = frame
closeBtn.MouseButton1Click:Connect(function()
	screenGui:Destroy()
end)

local minBtn = Instance.new("TextButton")
minBtn.Size = UDim2.new(0, 28, 0, 28)
minBtn.Position = UDim2.new(1, -65, 0, 2)
minBtn.BackgroundColor3 = Color3.fromRGB(80, 160, 255)
minBtn.Font = Enum.Font.GothamBold
minBtn.TextColor3 = Color3.fromRGB(255,255,255)
minBtn.TextSize = 20
minBtn.Text = "-"
minBtn.BorderSizePixel = 0
minBtn.Parent = frame

local isMinimized = false
local savedSize = frame.Size
local keepVisible = {minBtn, closeBtn}

local function setVisibleAll(state)
	for _, obj in ipairs(frame:GetChildren()) do
		if not table.find(keepVisible, obj) and obj:IsA("GuiObject") then
			obj.Visible = state
		end
	end
end

minBtn.MouseButton1Click:Connect(function()
	if not isMinimized then
		isMinimized = true
		savedSize = frame.Size
		frame.Size = UDim2.new(0, 80, 0, 40)
		minBtn.Text = "üéâ"
		setVisibleAll(false)
	else
		isMinimized = false
		frame.Size = savedSize
		minBtn.Text = "-"
		setVisibleAll(true)
	end
end)

-- Button Creator
local function makeButton(text, color, position)
	local btn = Instance.new("TextButton")
	btn.Size = UDim2.new(0.9, 0, 0, 40)
	btn.Position = position
	btn.BackgroundColor3 = color
	btn.TextColor3 = Color3.fromRGB(255,255,255)
	btn.Font = Enum.Font.GothamBold
	btn.TextSize = 18
	btn.Text = text
	btn.BorderSizePixel = 0
	btn.Parent = frame

	local corner = Instance.new("UICorner")
	corner.CornerRadius = UDim.new(0, 8)
	corner.Parent = btn
	return btn
end

-- Main buttons
local autoFishBtn = makeButton("üé£ Auto Fishing: ON", Color3.fromRGB(70,180,80), UDim2.new(0.05, 0, 0, 50))
local radarBtn = makeButton("üì° Radar: ON", Color3.fromRGB(70,180,255), UDim2.new(0.05, 0, 0, 100))
local rarityBtn = makeButton("üåà Rarity Detector: ON", Color3.fromRGB(150,80,255), UDim2.new(0.05, 0, 0, 150))

-- NEW BUTTONS (defaults ON)
local favoriteBtn = makeButton("‚≠ê Favorite (Mythic+Secret): ON", Color3.fromRGB(255,180,80), UDim2.new(0.05, 0, 0, 200))
local sellFilteredBtn = makeButton("üí∞ Auto Sell Filtered: ON", Color3.fromRGB(255,200,100), UDim2.new(0.05, 0, 0, 250))

local status = Instance.new("TextLabel")
status.Size = UDim2.new(1, -20, 0, 25)
status.Position = UDim2.new(0, 10, 1, -30)
status.BackgroundTransparency = 1
status.Text = "Status: Preparing fishing..."
status.TextColor3 = Color3.fromRGB(255,255,255)
status.TextSize = 16
status.Font = Enum.Font.Gotham
status.TextXAlignment = Enum.TextXAlignment.Left
status.Parent = frame

-- Toggles (all default ON as requested)
local autoFish = true
local radar = true
local rarityDetect = true
local favoriteEnabled = true
local autoSellFiltered = true
local busy = false

-- Prepare Fishing
local function prepareFishing()
	local char = player.Character or player.CharacterAdded:Wait()
	if char:FindFirstChild("HumanoidRootPart") then
		char.HumanoidRootPart.CFrame = CFrame.new(-3690.525, -135.074, -893.020)
		status.Text = "Status: Teleported to fishing spot..."
		task.wait(2)
	end
	if RE_Equip then
		RE_Equip:FireServer(1)
		status.Text = "Status: Fishing rod equipped..."
		task.wait(2)
	end
	status.Text = "Status: Ready to auto fish!"
end

-- Auto Fishing
local function doFish()
	if busy or not autoFish then return end
	busy = true
	status.Text = "Status: Casting..."
	task.wait(0.2)

	if not RF_Charge or not RF_Start or not RE_Complete then
		busy = false
		return
	end

	RF_Charge:InvokeServer(tick())
	task.wait(0.2)
	RF_Start:InvokeServer(math.random(-2,2), math.random(-2,2))
	task.wait(2 + math.random())
	RE_Complete:FireServer()
	status.Text = "Status: Fish caught!"
	task.wait(0.3)
	busy = false
end

-- Rarity Detector
local function checkRarity()
	if not rarityDetect or not FishingAreas then return end
	status.Text = "Status: Scanning rare fish..."
	for areaName, data in pairs(FishingAreas) do
		for _, fish in ipairs(data.Items) do
			if table.find(RareFishes, fish) then
				print("üåà Rare fish found in ["..areaName.."]: "..fish)
			end
		end
	end
	status.Text = "Status: Rarity scan done!"
end

-- AUTO FAVORITE (best-effort)
local function autoFavoriteFunc()
	-- tries to favorite Mythic/Secret items if possible
	while favoriteEnabled do
		task.wait(2)
		pcall(function()
			local inv = player:FindFirstChild("Inventory")
			-- two approaches: Inventory as objects with Rarity child, or ItemsModule from assets
			if inv and #inv:GetChildren() > 0 then
				for _, item in ipairs(inv:GetChildren()) do
					local rarity = (item:FindFirstChild("Rarity") and item.Rarity.Value) or nil
					if not rarity and ItemsModule and item.Name then
						-- lookup by name in items module (best-effort)
						local info = ItemsModule[item.Name]
						if info and info.rarity then rarity = info.rarity end
					end
					if rarity and RarityFavorite[rarity] then
						-- attempt to favorite via remote if available
						if REM_FAVORITE then
							pcall(function() REM_FAVORITE:FireServer(item.Name or item.UUID or item) end)
						end
					end
				end
			end
		end)
	end
end

-- Auto Sell Filtered (sell all except Mythic+Secret)
local function autoSellFilteredFunc()
	if not RF_SellAll then return end
	local inv = player:FindFirstChild("Inventory")
	if not inv then return end

	for _, item in ipairs(inv:GetChildren()) do
		local rarity = (item:FindFirstChild("Rarity") and item.Rarity.Value) or nil
		if not rarity and ItemsModule and item.Name then
			local info = ItemsModule[item.Name]
			if info and info.rarity then rarity = info.rarity end
		end

		if rarity then
			if RarityFavorite[rarity] then
				-- skip favorites
			else
				-- sell item (best-effort: call SellAll remote per item)
				pcall(function()
					RF_SellAll:InvokeServer(item.Name)
				end)
			end
		end
	end

	status.Text = "Status: Sold non-mythic/secret items!"
end

-- Auto Sell loop (runs because autoSellFiltered default true)
task.spawn(function()
	while task.wait(30) do
		if autoSellFiltered then
			autoSellFilteredFunc()
		end
	end
end)

-- start auto-favorite loop if enabled (default ON)
task.spawn(function()
	if favoriteEnabled then
		autoFavoriteFunc()
	end
end)

-- Button Events (toggle and UI update)
autoFishBtn.MouseButton1Click:Connect(function()
	autoFish = not autoFish
	autoFishBtn.Text = autoFish and "üé£ Auto Fishing: ON" or "üé£ Auto Fishing: OFF"
	autoFishBtn.BackgroundColor3 = autoFish and Color3.fromRGB(70,180,80) or Color3.fromRGB(180,50,50)
	status.Text = autoFish and "Status: Preparing fishing..." or "Status: Idle"
	if autoFish then task.spawn(prepareFishing) end
end)

radarBtn.MouseButton1Click:Connect(function()
	radar = not radar
	radarBtn.Text = radar and "üì° Radar: ON" or "üì° Radar: OFF"
	radarBtn.BackgroundColor3 = radar and Color3.fromRGB(70,180,255) or Color3.fromRGB(60,100,180)
	if RF_Radar then RF_Radar:InvokeServer(radar) end
end)

rarityBtn.MouseButton1Click:Connect(function()
	rarityDetect = not rarityDetect
	rarityBtn.Text = rarityDetect and "üåà Rarity Detector: ON" or "üåà Rarity Detector: OFF"
	rarityBtn.BackgroundColor3 = rarityDetect and Color3.fromRGB(150,80,255) or Color3.fromRGB(180,100,255)
	if rarityDetect then checkRarity() end
end)

favoriteBtn.MouseButton1Click:Connect(function()
	favoriteEnabled = not favoriteEnabled
	if favoriteEnabled then
		favoriteBtn.Text = "‚≠ê Favorite: ON"
		favoriteBtn.BackgroundColor3 = Color3.fromRGB(255,180,80)
		task.spawn(autoFavoriteFunc)
	else
		favoriteBtn.Text = "‚≠ê Favorite: OFF"
		favoriteBtn.BackgroundColor3 = Color3.fromRGB(255,140,60)
	end
end)

sellFilteredBtn.MouseButton1Click:Connect(function()
	autoSellFiltered = not autoSellFiltered
	if autoSellFiltered then
		sellFilteredBtn.Text = "üí∞ Auto Sell Filtered: ON"
		sellFilteredBtn.BackgroundColor3 = Color3.fromRGB(255,200,100)
	else
		sellFilteredBtn.Text = "üí∞ Auto Sell Filtered: OFF"
		sellFilteredBtn.BackgroundColor3 = Color3.fromRGB(200,120,40)
	end
end)

-- Main Loop
task.spawn(function()
	prepareFishing()
	while task.wait(0.1) do
		if autoFish then doFish() end
	end
end)

-- Anti AFK
local VirtualUser = game:GetService('VirtualUser')
player.Idled:Connect(function()
	VirtualUser:CaptureController()
	VirtualUser:ClickButton2(Vector2.new())
end)

game:GetService("StarterGui"):SetCore("SendNotification", {
	Title = "Anti AFK loaded!",
	Text = "Made by Tuuguu936",
	Button1 = "Okay",
	Duration = 5
})
